import{g as y,O as w,a as C}from"./opaque_client.js";const r=y(w.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("login-form");e&&e.addEventListener("submit",async c=>{c.preventDefault();const o=new FormData(e),t=o.get("username"),l=o.get("password"),n=new C(r),s=await n.authInit(l),d=s.serialize(),g=btoa(String.fromCharCode(...d));console.log(s);const m=await fetch("/api/login/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,ke1Base64:g})}),p=new Uint8Array(atob(m.ke2Base64).split("").map(k=>k.charCodeAt(0))),a=KE2.deserialize(r,Array.from(p));console.log("we got ke2"),console.log(a);const i=n.authFinish(a);console.log("we got ke3"),console.log(i);const f=i.serialize(),u=btoa(String.fromCharCode(...f)),h=await fetch("/api/login/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,ke3Base64:u})});console.log(h)})});
