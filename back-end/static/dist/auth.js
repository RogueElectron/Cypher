import{g as p,O as d,a as m}from"./opaque_client.js";const g=p(d.OPAQUE_P256),u="Digitopia-opaque-server";document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("login-form");e&&e.addEventListener("submit",async a=>{a.preventDefault();const t=new FormData(e),n=t.get("username"),i=t.get("password"),s=new m(g),r=await s.authInit(i),c=await(await fetch("/api/login/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ke1:r,username:n})})).json(),o=await s.authFinish(c,u,n);console.log(o.sessionKey,"session key"),fetch("/api/login/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,ke3:o.ke3})})})});
