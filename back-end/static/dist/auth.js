import{g as y,O as C,a as O,K as B}from"./opaque_client.js";const r=y(C.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("login-form");e&&e.addEventListener("submit",async c=>{c.preventDefault();const o=new FormData(e),t=o.get("username"),l=o.get("password"),n=new O(r),s=await n.authInit(l),g=s.serialize(),d=btoa(String.fromCharCode(...g));console.log(s);const p=await fetch("/api/login/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,ke1Base64:d})});console.log("got response");const m=(await p.json()).ke2Base64,f=new Uint8Array(atob(m).split("").map(w=>w.charCodeAt(0))),a=B.deserialize(r,Array.from(f));console.log("we got ke2"),console.log(a);const i=await n.authFinish(a);console.log("we got ke3"),console.log(i);const k=i.serialize(),u=btoa(String.fromCharCode(...k)),h=await fetch("/api/login/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,ke3Base64:u})});console.log(h)})});
