import{g as C,O,a as B,K as S}from"./opaque_client.js";const c=C(O.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("login-form");e&&e.addEventListener("submit",async l=>{l.preventDefault();const t=new FormData(e),n=t.get("username"),g=t.get("password"),s=new B(c),a=await s.authInit(g),d=a.serialize(),p=btoa(String.fromCharCode(...d));console.log(a);const m=await fetch("/api/login/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,ke1Base64:p})});console.log("got response");const f=(await m.json()).ke2Base64,u=new Uint8Array(atob(f).split("").map(w=>w.charCodeAt(0))),i=S.deserialize(c,Array.from(u));console.log("we got ke2"),console.log(i);const r=await s.authFinish(i),o=r.ke3;console.log("authfinishresult",r),console.log("ke3 type:",typeof o),console.log("ke3:",o);const h=o.serialize(),k=btoa(String.fromCharCode(...h)),y=await fetch("/api/login/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,ke3Base64:k})});console.log(y)})});
