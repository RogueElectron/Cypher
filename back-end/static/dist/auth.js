import{g as m,O as h,a as f,K as u}from"./opaque_client.js";const r=m(h.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("login-form");e&&e.addEventListener("submit",async c=>{c.preventDefault();const t=new FormData(e),n=t.get("username"),l=t.get("password"),s=new f(r),d=(await s.authInit(l)).serialize(),p=(await(await fetch("http://localhost:3000/login/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,serke1:d})})).json()).ser_ke2,g=u.deserialize(r,p),o=await s.authFinish(g);console.log(o);const a=o.ke3;console.log(a);const i=a.serialize();console.log(i),await fetch("http://localhost:3000/login/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,serke3:i})})})});
