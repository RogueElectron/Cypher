import{g as m,O as g,a as h,K as f}from"./opaque_client.js";const a=m(g.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("login-form");e&&e.addEventListener("submit",async i=>{i.preventDefault();const s=new FormData(e),t=s.get("username"),r=s.get("password"),n=new h(a),c=(await n.authInit(r)).serialize(),l=(await(await fetch("http://localhost:3000/login/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,serke1:c})})).json()).ser_ke2,d=f.deserialize(a,l),o=await n.authFinish(d),p=o.ke3.serialize();console.log("session",o.session_key),await fetch("http://localhost:3000/login/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,serke3:p})})})});
