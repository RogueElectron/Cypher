import{g as y,O as C,a as O,K as B}from"./opaque_client.js";const r=y(C.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("login-form");e&&e.addEventListener("submit",async c=>{c.preventDefault();const t=new FormData(e),n=t.get("username"),l=t.get("password"),s=new O(r),a=await s.authInit(l),g=a.serialize(),d=btoa(String.fromCharCode(...g));console.log(a);const p=await fetch("/api/login/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,ke1Base64:d})});console.log("got response");const m=(await p.json()).ke2Base64,f=new Uint8Array(atob(m).split("").map(w=>w.charCodeAt(0))),i=B.deserialize(r,Array.from(f));console.log("we got ke2"),console.log(i);const o=await s.authFinish(i);console.log("we got ke3",o),console.log(o);const k=o.serialize(),u=btoa(String.fromCharCode(...k)),h=await fetch("/api/login/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,ke3Base64:u})});console.log(h)})});
