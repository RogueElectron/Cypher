import{g as u,O as f,a as m}from"./opaque_client.js";const y=u(f.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("register-form");e&&e.addEventListener("submit",async o=>{o.preventDefault();const a="Digitopia-opaque-server",n=new FormData(e),t=n.get("username"),c=n.get("password"),r=new m(y),d=await r.registerInit(c),s=await fetch("/api/register/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,registrationRequest:d})});if(!s.ok)throw new Error("Registration failed");const{registrationResponse:i}=await s.json(),p={evaluation:new Uint8Array(i.evaluation),server_public_key:new Uint8Array(i.server_public_key)},g=await r.registerFinish(p,t,a);fetch("/api/register/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,registrationRecord:g.record})})})});
