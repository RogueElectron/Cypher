import{g as m,O as f,a as l}from"./opaque_client.js";const y=m(f.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("register-form");e&&e.addEventListener("submit",async i=>{i.preventDefault();const a="Digitopia-opaque-server",r=new FormData(e),t=r.get("username"),c=r.get("password"),n=new l(y),d=await n.registerInit(c),s=await fetch("/api/register/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,registrationRequest:d})});if(!s.ok)throw new Error("Registration failed");const{registrationResponse:o}=await s.json(),p={evaluation:new Uint8Array(o.evaluation),server_public_key:new Uint8Array(o.server_public_key)},g=(await n.registerFinish(p,t,a)).record.serialize(),u=btoa(String.fromCharCode(...g));fetch("/api/register/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,registrationRecord:u})})})});
