import{g as m,O as u,a as l,R as f}from"./opaque_client.js";const r=m(u.OPAQUE_P256);document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("register-form");e&&e.addEventListener("submit",async o=>{o.preventDefault();const t=new FormData(e),s=t.get("username"),a=t.get("password"),n=new l(r),i=(await n.registerInit(a)).serialize(),c=await fetch("http://localhost:3000/register/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,registrationRequest:i})}),{registrationResponse:d}=await c.json(),g=f.deserialize(r,d),p=(await n.registerFinish(g)).record.serialize();fetch("http://localhost:3000/register/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,record:p})})})});
